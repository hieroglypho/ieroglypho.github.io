<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŒôŒïŒ°ŒüŒìŒõŒ•Œ¶Œ©</title>
    <!-- mobiles redirects -->
    <script>
        if (/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
            window.location.href = "https://www.hieroglyphica.org/mobile.html";
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Egyptian+Hieroglyphs&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="main.css">

    <!-- 3rd party Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.2.4/fabric.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

</head>

<body>
    <div class="container">
        <!-- Workspace container with background and canvas -->
        <div id="workspaceContainer" style="position: relative;">
            <div id="backgroundContainer"
                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;">
                <img id="bgImage" style="opacity: 0.5; max-width: 100%; max-height: 100%; display: none;">
            </div>
            <canvas id="c" tabindex="0" style="position: relative; z-index: 1;"></canvas>
            <!-- Gardiner's code section -->
            <div id="pastedNamesContainer">
                <h4 style="margin: 0; display: inline-block;">Gardiner:</h4>
                <div id="pastedNames"></div>
            </div>
            <div id="fixedTextOverlay">
                ŒôŒïŒ°ŒüŒìŒõŒ•Œ¶Œ© 1.5
            </div>

        </div>

        <div id="searchContainer" style="position: relative;">
            <input type="text" id="searchInput" placeholder="Search characters or names...">
            <div class="dropdown">
                <button id="dropdownButton">or A, B, C..</button>
                <div id="dropdownContent" class="dropdown-content">
                    <!-- Dynamic sentence links will be inserted here via JavaScript -->
                </div>
            </div>
            <div id="charListContainer">
                <div id="charList"></div>
            </div>

            <!-- Modified search section -->
            <div id="secondarySearch">
                <div class="file-upload-row">
                    <input type="file" id="dictionaryFileInput" accept=".txt" class="file-input" style="display: none;">
                    <button onclick="triggerFileInput()" class="upload-button">Upload Dictionary</button>
                    <span id="fileStatus" class="file-status"></span>
                </div>
                <div class="search-row">
                    <input type="text" id="fygusSearchInput" placeholder="Search terms (e.g., A1 Z2 or rHty)"
                        class="search-input">
                    <button onclick="searchFygusFile()" class="search-button">Search</button>
                </div>
                <div id="resultDisplay" class="result-container"></div>
            </div>
            <!-- </div> -->
        </div>
    </div>

    <!-- Workspace Control Buttons -->
    <div id="tools">
        <div class="tool-group">
            <button onclick="addCartouche()" title="Add a Cartouche">Cartouche</button>
            <button onclick="addLine()" title="Add a Line">‚îÄ‚îÄ</button>
            <button onclick="addArrow()" title="Add an Arrow">‚ü∂</button>
            <button onclick="addCustomRect()" title="Add a Rectangle">‚ñ≠</button>
            <button onclick="addCircle()" title="Add a Circle">‚óØ</button>
            <button onclick="addPencilLine()" title="Add a Freehand Line">‚úé</button>
            <button onclick="addSquareBracket()" title="Add Square Brackets">[</button>
            <button onclick="addSpeechBubble()" title="Add a Speech Bubble">üí¨</button>

            <input type="file" id="bgImageInput" accept="image/*" style="display: none">
            <button title="Enter text" onclick="openKeyboard()">‚å®</button>
            <button onclick="document.getElementById('bgImageInput').click()"
                title="Upload background image">BG</button>
            <button title="Choose canvas color" onclick="toggleColorPopup()">üé®</button>
        </div>
        <div id="colorPopup"
            style="display: none; position: absolute; background: white; padding: 10px; border: 1px solid black;">
            <div style="display: flex; gap: 5px;">
                <div class="color-swatch" style="background: #636363;" onclick="setCanvasColor('#636363')"></div>
                <div class="color-swatch" style="background: #998b60;" onclick="setCanvasColor('#998b60')"></div>
                <div class="color-swatch" style="background: #8F9D91;" onclick="setCanvasColor('#8F9D91')"></div>
                <div class="color-swatch" style="background: #4F4A45;" onclick="setCanvasColor('#4F4A45')"></div>
            </div>
        </div>
        <!-- ======== DONATE ============ -->
        <button onclick="window.open('https://www.paypal.com/ncp/payment/PMWMHAY55RZSE', '_blank')"
            class="rainbow-donate" title="Donate!">
            <span>$:)</span>
        </button>
        <!-- Background Controls -->
        <div class="slider-controls">
            <div class="slider-group">
                <label class="slider-label" title="Background Opacity" for="bgOpacity">BG Œ±:</label>
                <input type="range" id="bgOpacity" min="0" max="100" value="100" class="compact-slider">
                <span class="slider-value" id="opacityValue">50%</span>
            </div>

            <!-- Workspace Actions -->
            <div class="workspace-actions">
                <button id="saveWorkspaceBtn" class="action-btn" title="Save document to json">Save</button>
                <div id="saveMenu" class="save-menu hidden">
                    <button id="saveAsJsonBtn">Save as JSON</button>
                    <button id="saveAsPdfBtn">Save as PDF</button>
                </div>
                <button id="loadWorkspaceBtn" class="action-btn" title="Open exhisting json file">Open</button>
                <button id="help" class="action-btn" title="Help Documentation">ìèû</button>
                <button class="action-btn" title="All Gardiner signs"
                    onclick="window.open('https://en.wikipedia.org/wiki/List_of_Egyptian_hieroglyphs#Letter_classification_by_Gardiner', '_blank')">Wiki</button>
            </div>
        </div>

        <!-- Help overlay -->
        <div class="help-overlay" id="helpOverlay">
            <iframe src="help-content.html" class="help-content-frame" id="helpContent"></iframe>
        </div>

        <!-- POPUP KEYBOARD -->
        <div class="keyboard-overlay" id="keyboardOverlay"></div>
        <div class="keyboard-dialog" id="keyboardDialog">
            <div class="input-container">
                <textarea class="keyboard-input" id="keyboardInput"
                    placeholder="Type or click characters..."></textarea>
                <input type="number" id="keyboardFontSize" class="font-size-input" value="18" min="8" max="72">
            </div>

            <div class="keyboard-rows">
                <div class="keyboard-row special-chars">
                    <div class="key">Íú£</div>
                    <div class="key">Íú•</div>
                    <div class="key">·∏•</div>
                    <div class="key">·∏´</div>
                    <div class="key">·∫ñ</div>
                    <div class="key">≈°</div>
                    <div class="key">·∏≥</div>
                    <div class="key">·πØ</div>
                    <div class="key">·∏è</div>
                </div>
                <!-- Divider -->
                <div class="divider"></div>
                <div class="keyboard-row coptic-label">
                    <span>Coptic</span>
                </div>
                <div class="keyboard-row coptic-chars">
                    <div class="key">‚≤Å</div>
                    <div class="key">‚≤É</div>
                    <div class="key">‚≤Ö</div>
                    <div class="key">‚≤á</div>
                    <div class="key">‚≤â</div>
                    <div class="key">‚≤ã</div>
                    <div class="key">‚≤ç</div>
                    <div class="key">‚≤è</div>
                    <div class="key">‚≤ë</div>
                    <div class="key">‚≤ì</div>
                </div>
                <div class="keyboard-row coptic-chars">
                    <div class="key">‚≤ï</div>
                    <div class="key">‚≤ó</div>
                    <div class="key">‚≤ô</div>
                    <div class="key">‚≤õ</div>
                    <div class="key">‚≤ù</div>
                    <div class="key">‚≤ü</div>
                    <div class="key">‚≤°</div>
                    <div class="key">‚≤£</div>
                    <div class="key">‚≤•</div>
                    <div class="key">‚≤ß</div>
                </div>
            </div>


            <div class="dialog-buttons">
                <button class="dialog-btn cancel" onclick="closeKeyboard()">Cancel</button>
                <button class="dialog-btn add" onclick="addKeyboardText()">Add Text</button>
            </div>
        </div>

        <script src="chars.js"></script>
        <script src="script.js"></script>
        <script src="fjgus.js"></script>

</body>
